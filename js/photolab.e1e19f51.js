"use strict";(self["webpackChunkphotolab"]=self["webpackChunkphotolab"]||[]).push([[393],{4243:function(t,e,s){s.r(e),s.d(e,{default:function(){return w}});var i=s(7179),a=s(6904),r=s(5057),o=s(2469),n=s(549),l=s(2021),d=s(7615),h=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"photolab"}},[!1===t.isLoading?e(l.Z,{attrs:{multiple:""},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[e(d.Z,{attrs:{"justify-center":""}},[e("div",{staticClass:"grid"},[e("Photoswipe",{attrs:{bubble:""}},[e("div",{directives:[{name:"masonry",rawName:"v-masonry",value:t.containerId,expression:"containerId"}],attrs:{"transition-duration":"0.3s","item-selector":".item"}},t._l(t.imgsArr,(function(s,l){return e("div",{directives:[{name:"masonry-tile",rawName:"v-masonry-tile"}],key:l,staticClass:"item"},[e(o.Z,{directives:[{name:"pswp",rawName:"v-pswp",value:s,expression:"props"}],attrs:{src:s.src}}),e(n.Z,{attrs:{value:s.p_id},scopedSlots:t._u([{key:"default",fn:function({active:o,toggle:n}){return[e(a.Z,{on:{submit:function(e){return e.preventDefault(),t.onSubmit(s,o)}}},[t.user.account.length>0?e(i.Z,{attrs:{icon:"",type:"submit"},on:{click:n}},[e(r.Z,{attrs:{color:"rgba(255, 255, 255, 0.7)"}},[t._v(t._s(o?"mdi-heart":"mdi-heart-outline"))])],1):t._e()],1)]}}],null,!0)})],1)})),0)])],1)])],1):t._e()],1)},u=[],c=(s(7658),s(7564)),p=s.n(c),m=s(8751),g=s.n(m),v={name:"Photolab",data(){return{imgsArr:[],props:"",selected:[],like:[],isLoading:!0,isActive:!1}},computed:{user(){return this.$store.state.user}},methods:{onSubmit(t,e){!0===e?(console.log(t),this.axios.post("https://gp-photolab.onrender.com/users/image/"+this.$store.state.user.id,t).then((t=>{t.data.success?this.active=!0:this.$swal({icon:"error",title:"發生錯誤",text:t.data.message})})).catch((t=>{this.$swal({icon:"error",title:"發生錯誤",text:t.response.data.message})}))):!1===e&&this.axios.delete("https://gp-photolab.onrender.com/users/image/"+this.$store.state.user.id+"/"+t.p_id).then((t=>{t.data.success?this.active=!1:this.$swal({icon:"error",title:"錯誤",text:t.data.message})})).catch((t=>{this.$swal({icon:"error",title:"錯誤",text:t.response.data.message})}))}},updated(){const t=document.querySelector(".grid"),e=new(g())(t,{itemSelector:".item",fitWidth:"true"});p()(".item",(()=>{setTimeout((()=>{e.layout()}),1e3)}))},mounted(){this.axios.get("https://gp-photolab.onrender.com/photos/").then((t=>{t.data.success?(this.imgsArr=t.data.result.map((t=>(t.src="https://gp-photolab.onrender.com/photos/file/"+t.file,t.p_id=t._id,t.title=t.description,t))),this.imgsArr.reverse()):this.$swal({icon:"error",title:"錯誤",text:t.data.message})})).catch((t=>{"未登入"===t.response.data.message&&(this.$store.commit("logout"),"/login"!==this.$route.path&&this.$router.push("/login")),this.$swal({icon:"error",title:"錯誤",text:t.response.data.message})})),this.user.account.length>0&&this.axios.get("https://gp-photolab.onrender.com/users/image/"+this.user.id).then((t=>{if(t.data.success){const e=t.data.result.images;for(let t=0;t<e.length;t++)this.selected.push(e[t].p_id)}else this.$swal({icon:"error",title:"錯誤",text:t.data.message})})).catch((t=>{"未登入"===t.response.data.message&&(this.$store.commit("logout"),"/login"!==this.$route.path&&this.$router.push("/login")),this.$swal({icon:"error",title:"錯誤",text:t.response.data.message})})),this.$nextTick((()=>{this.isLoading=!1}))}},f=v,b=s(1001),$=(0,b.Z)(f,h,u,!1,null,null,null),w=$.exports},6904:function(t,e,s){s(7658);var i=s(4987),a=s(4609),r=s(380);e.Z=(0,i.Z)(a.Z,(0,r.J)("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(t){const e=Object.values(t).includes(!0);this.$emit("input",!e)},deep:!0,immediate:!0}},methods:{watchInput(t){const e=t=>t.$watch("hasError",(e=>{this.$set(this.errorBag,t._uid,e)}),{immediate:!0}),s={_uid:t._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?s.shouldValidate=t.$watch("shouldValidate",(i=>{i&&(this.errorBag.hasOwnProperty(t._uid)||(s.valid=e(t)))})):s.valid=e(t),s},validate(){return 0===this.inputs.filter((t=>!t.validate(!0))).length},reset(){this.inputs.forEach((t=>t.reset())),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)},resetValidation(){this.inputs.forEach((t=>t.resetValidation())),this.resetErrorBag()},register(t){this.inputs.push(t),this.watchers.push(this.watchInput(t))},unregister(t){const e=this.inputs.find((e=>e._uid===t._uid));if(!e)return;const s=this.watchers.find((t=>t._uid===e._uid));s&&(s.valid(),s.shouldValidate()),this.watchers=this.watchers.filter((t=>t._uid!==e._uid)),this.inputs=this.inputs.filter((t=>t._uid!==e._uid)),this.$delete(this.errorBag,e._uid)}},render(t){return t("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:t=>this.$emit("submit",t)}},this.$slots.default)}})},7615:function(t,e,s){s(9027);var i=s(2071);e.Z=(0,i.Z)("layout")},549:function(t,e,s){s.d(e,{P:function(){return n},Z:function(){return l}});var i=s(4791),a=s(4987),r=s(6596),o=s(144);const n=o["default"].extend({props:{activeClass:String,value:{required:!1},disabled:Boolean},data:()=>({isActive:!1}),methods:{toggle(){this.isActive=!this.isActive}},render(){if(!this.$scopedSlots.default)return(0,r.Kd)("v-item is missing a default scopedSlot",this),null;let t;return this.$scopedSlots.default&&(t=this.$scopedSlots.default({active:this.isActive,toggle:this.toggle})),Array.isArray(t)&&1===t.length&&(t=t[0]),t&&!Array.isArray(t)&&t.tag?(t.data=this._b(t.data||{},t.tag,{class:{[this.activeClass]:this.isActive,"v-item--disabled":this.disabled}}),this.disabled&&(t.data.attrs={...t.data.attrs,tabindex:-1}),t):((0,r.Kd)("v-item should only contain a single element",this),t)}});var l=(0,a.Z)(n,(0,i.d)("itemGroup","v-item","v-item-group")).extend({name:"v-item"})}}]);
//# sourceMappingURL=photolab.e1e19f51.js.map